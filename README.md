# FirstNoReapting
### 题目要求

有一个 100GB 的文件，里面内容是文本，要求：找出第一个不重复的词（只允许扫一遍原文件），内存大小32GB。文本数据里均为英文单词，为简化问题，假设英文单词之间分隔符只为空格，不区分大小写。

### 整体思路

当内存无法全部存下所有数据时，常见思路就是文件分片

- 首先，将100g文件，分为100份，具体如下图：

  ![image](https://github.com/Qiwc/FirstNoReapting/blob/master/images/1.png)

- 每个分片文件头部用4个字节表示该分片内单词数量。每个word分为三个部分：单词长度、存储的是单词、单词在原文中位置（index）。且每个分片文件内按单词字典序排列。具体如下图：

  ![image](https://github.com/Qiwc/FirstNoReapting/blob/master/images/2.png)

- 最后对所有分片文件进行归并排序，读取到index最小的且重复的单词就是第一个不重复的词

### 本地测试

本地在MAC上小数据量测试，测试结果ok，还有待进行大数据量测试

### 已对IO进行优化，具体如下：

文件分片时，采用大块读写方式。使用FileChannel配合DirectBuffer的方式，每次1GB的大小进行读写。这种方式可减少IO次数，而且直接使用堆外内存可减少堆内与堆外拷贝的cpu消耗。因分配堆外内存较为耗时，已实现读写复用DirectBuffer。归并时，对100个分片文件进行了内存映射，减少系统调用次数。

### 